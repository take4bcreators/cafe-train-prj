-- 接続駅情報併合 テーブルへの挿入
INSERT INTO :schema.tmp_merge_joininfo (
    station_cd,
    next_station_cd,
    numbering,
    station_name,
    new_line_cd,
    origin_line_cd,
    e_status,
    e_sort,
    lat,
    lon,
    cflag01,
    cflag02,
    cflag03,
    cflag04,
    cflag05,
    cflag06,
    cflag07,
    cflag08,
    cflag09,
    cflag10,
    cflag11,
    cflag12,
    cflag13,
    cflag14,
    cflag15,
    cflag16,
    cflag17,
    cflag18,
    cflag19,
    cflag20,
    cflag21,
    cflag22,
    cflag23,
    cflag24,
    cflag25,
    cflag26,
    cflag27,
    cflag28,
    cflag29,
    cflag30,
    cflag31,
    cflag32,
    cflag33,
    cflag34,
    cflag35,
    cflag36,
    cflag37,
    cflag38,
    cflag39,
    cflag40
)
SELECT
    T1.station_cd,
    COALESCE(T2.station_cd2, 0) AS next_station_cd,
    T1.numbering,
    T1.station_name,
    T1.new_line_cd,
    T1.origin_line_cd,
    T1.e_status,
    T1.e_sort,
    T1.lat,
    T1.lon,
    T1.cflag01,
    T1.cflag02,
    T1.cflag03,
    T1.cflag04,
    T1.cflag05,
    T1.cflag06,
    T1.cflag07,
    T1.cflag08,
    T1.cflag09,
    T1.cflag10,
    T1.cflag11,
    T1.cflag12,
    T1.cflag13,
    T1.cflag14,
    T1.cflag15,
    T1.cflag16,
    T1.cflag17,
    T1.cflag18,
    T1.cflag19,
    T1.cflag20,
    T1.cflag21,
    T1.cflag22,
    T1.cflag23,
    T1.cflag24,
    T1.cflag25,
    T1.cflag26,
    T1.cflag27,
    T1.cflag28,
    T1.cflag29,
    T1.cflag30,
    T1.cflag31,
    T1.cflag32,
    T1.cflag33,
    T1.cflag34,
    T1.cflag35,
    T1.cflag36,
    T1.cflag37,
    T1.cflag38,
    T1.cflag39,
    T1.cflag40
FROM
    :schema.tmp_merge_stationinfo T1
LEFT OUTER JOIN
    :schema.ejp_join T2
ON
    T1.station_cd = T2.station_cd1
    AND T1.origin_line_cd = T2.line_cd
;
