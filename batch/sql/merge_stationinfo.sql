-- 駅情報併合テーブルへの挿入
INSERT INTO :schema.tmp_merge_stationinfo (
    station_cd,
    station_name,
    new_line_cd,
    origin_line_cd,
    e_status,
    e_sort,
    lat,
    lon,
    cflag01,
    cflag02,
    cflag03,
    cflag04,
    cflag05,
    cflag06,
    cflag07,
    cflag08,
    cflag09,
    cflag10,
    cflag11,
    cflag12,
    cflag13,
    cflag14,
    cflag15,
    cflag16,
    cflag17,
    cflag18,
    cflag19,
    cflag20,
    cflag21,
    cflag22,
    cflag23,
    cflag24,
    cflag25,
    cflag26,
    cflag27,
    cflag28,
    cflag29,
    cflag30,
    cflag31,
    cflag32,
    cflag33,
    cflag34,
    cflag35,
    cflag36,
    cflag37,
    cflag38,
    cflag39,
    cflag40
)
SELECT
    T1.station_cd,
    T1.station_name,
    T1.new_line_cd,
    T1.origin_line_cd,
    T1.e_status,
    T1.e_sort,
    T1.lat,
    T1.lon,
    T2.cflag01,
    T2.cflag02,
    T2.cflag03,
    T2.cflag04,
    T2.cflag05,
    T2.cflag06,
    T2.cflag07,
    T2.cflag08,
    T2.cflag09,
    T2.cflag10,
    T2.cflag11,
    T2.cflag12,
    T2.cflag13,
    T2.cflag14,
    T2.cflag15,
    T2.cflag16,
    T2.cflag17,
    T2.cflag18,
    T2.cflag19,
    T2.cflag20,
    T2.cflag21,
    T2.cflag22,
    T2.cflag23,
    T2.cflag24,
    T2.cflag25,
    T2.cflag26,
    T2.cflag27,
    T2.cflag28,
    T2.cflag29,
    T2.cflag30,
    T2.cflag31,
    T2.cflag32,
    T2.cflag33,
    T2.cflag34,
    T2.cflag35,
    T2.cflag36,
    T2.cflag37,
    T2.cflag38,
    T2.cflag39,
    T2.cflag40
FROM
    :schema.tmp_merge_defined_stationinfo T1
LEFT OUTER JOIN
    :schema.tmp_filtering_newest_cafeinfo T2
ON
    T1.lat = T2.search_lat
    AND T1.lon = T2.search_lon
;
